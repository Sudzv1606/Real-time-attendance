<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4f46e5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Attendr">

    <title>Attendr</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%234f46e5'/%3E%3Ctext x='16' y='22' font-family='Arial' font-size='16' fill='white' text-anchor='middle'%3E📚%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="/icons/icon-180.png">
    <link rel="apple-touch-startup-image" href="/icons/splash.png">

    <!-- Styles -->
    <link rel="stylesheet" href="app.css">

    <!-- Preload critical resources -->
    <link rel="preload" href="app.js" as="script">
</head>
<body>
    <!-- Setup Screen (shown initially if no courses exist) -->
    <div id="setup-screen" class="screen">
        <div class="container">
            <header class="header">
                <h1>📚 Setup Your Courses</h1>
                <p>Add your courses to start tracking attendance</p>
            </header>

            <form id="course-form" class="course-form">
                <div class="form-group">
                    <label for="course-name">Course Name</label>
                    <input type="text" id="course-name" placeholder="e.g., Math 101" required>
                </div>

                <div class="form-group">
                    <label for="total-lectures">Total Lectures</label>
                    <input type="number" id="total-lectures" placeholder="40" min="1" required>
                </div>

                <div class="form-group">
                    <label for="target-percent">Target %</label>
                    <input type="number" id="target-percent" placeholder="75" min="1" max="100" value="75" required>
                </div>

                <button type="submit" class="btn btn-primary">Add Course</button>
            </form>

            <div id="courses-list" class="courses-list">
                <!-- Added courses will appear here -->
            </div>

            <div class="setup-actions">
                <button id="done-setup" class="btn btn-success" style="display: none;">
                    ✓ Done Setup
                </button>
            </div>
        </div>
    </div>

    <!-- Dashboard Screen (main screen) -->
    <div id="dashboard-screen" class="screen" style="display: none;">
        <div class="container">
            <header class="header">
                <h1>📊 Attendance Tracker</h1>
                <p>Keep your attendance on track</p>
                <button id="dark-mode-toggle" class="dark-mode-toggle">🌙</button>
            </header>

            <div id="overall-summary" class="overall-summary">
                <!-- Overall stats will be shown here -->
            </div>

            <div id="courses-grid" class="courses-grid">
                <!-- Course cards will be rendered here -->
            </div>

            <div class="dashboard-actions">
                <button id="add-course-btn" class="btn btn-secondary">+ Add Course</button>
            </div>
        </div>
    </div>

    <!-- Course Detail Modal -->
    <div id="detail-modal" class="modal" style="display: none;">
        <div class="modal-content large-modal">
            <div class="detail-modal-header">
                <h2 id="detail-course-title">Course Details</h2>
                <button id="close-detail-modal" class="close-btn">&times;</button>
            </div>

            <div class="detail-content">
                <!-- Enhanced Stats Grid -->
                <div class="detail-stats-grid">
                    <div class="detail-stat-card">
                        <div class="detail-stat-number" id="detail-attended">0</div>
                        <div class="detail-stat-label">Lectures Attended</div>
                    </div>
                    <div class="detail-stat-card">
                        <div class="detail-stat-number" id="detail-remaining">0</div>
                        <div class="detail-stat-label">Lectures Remaining</div>
                    </div>
                    <div class="detail-stat-card">
                        <div class="detail-stat-number" id="detail-percentage">0%</div>
                        <div class="detail-stat-label">Current Percentage</div>
                    </div>
                </div>

                <!-- Progress Section -->
                <div class="progress-section">
                    <h3>Progress to Target</h3>
                    <div class="detail-progress-bar">
                        <div class="detail-progress-fill" id="detail-progress-fill"></div>
                    </div>
                    <p class="detail-target-status" id="detail-target-status">Target: 75%</p>
                </div>

                <!-- Quick Info Cards -->
                <div class="detail-info-grid">
                    <div class="detail-info-card">
                        <div class="detail-info-header">
                            <span class="detail-info-icon">🕐</span>
                            <span class="detail-info-title">Last Marked</span>
                        </div>
                        <div class="detail-info-content">
                            <span class="detail-info-label">Time & Date:</span>
                            <span class="detail-info-value" id="detail-last-marked">Never</span>
                        </div>
                    </div>
                    <div class="detail-info-card">
                        <div class="detail-info-header">
                            <span class="detail-info-icon">✅</span>
                            <span class="detail-info-title">Safe to Skip</span>
                        </div>
                        <div class="detail-info-content">
                            <span class="detail-info-label">Lectures:</span>
                            <span class="detail-info-value" id="detail-safe-skip">0</span>
                        </div>
                    </div>
                    <div class="detail-info-card">
                        <div class="detail-info-header">
                            <span class="detail-info-icon">🎯</span>
                            <span class="detail-info-title">Need to Attend</span>
                        </div>
                        <div class="detail-info-content">
                            <span class="detail-info-label">Lectures:</span>
                            <span class="detail-info-value" id="detail-need-attend">0</span>
                        </div>
                    </div>
                </div>

                <!-- Attendance History -->
                <div class="attendance-history">
                    <h3>📋 Attendance Records</h3>
                    <div id="history-list" class="history-list">
                        <!-- Attendance records will be populated here -->
                    </div>
                    <div id="no-history" class="no-history" style="display: none;">
                        <p>📝 No attendance records yet. Start marking your attendance!</p>
                    </div>
                </div>

                <!-- Attendance Statistics -->
                <div class="attendance-statistics">
                    <h3>📊 Attendance Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">📅</div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-total-days">0</div>
                                <div class="stat-label">Total Days Attended</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">🔥</div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-longest-streak">0</div>
                                <div class="stat-label">Longest Streak</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">📈</div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-avg-week">0</div>
                                <div class="stat-label">Avg per Week</div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">🕐</div>
                            <div class="stat-content">
                                <div class="stat-value" id="stat-most-active">N/A</div>
                                <div class="stat-label">Most Active Day</div>
                            </div>
                        </div>
                    </div>

                    <div class="time-slots">
                        <h4>⏰ Attendance by Time Slot</h4>
                        <div id="time-slot-stats" class="time-slot-stats">
                            <!-- Time slot statistics will be populated here -->
                        </div>
                    </div>

                    <div class="weekday-stats">
                        <h4>📅 Attendance by Day</h4>
                        <div id="weekday-stats" class="weekday-bars">
                            <!-- Weekday statistics will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="detail-actions">
                    <button id="mark-from-detail" class="btn btn-success">+ Mark Attendance</button>
                    <button id="edit-from-detail" class="btn btn-secondary">Edit Course</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Course Modal -->
    <div id="edit-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Course</h2>
                <button id="close-edit-modal" class="close-btn">&times;</button>
            </div>

            <form id="edit-course-form" class="course-form">
                <input type="hidden" id="edit-course-id">

                <div class="form-group">
                    <label for="edit-course-name">Course Name</label>
                    <input type="text" id="edit-course-name" required>
                </div>

                <div class="form-group">
                    <label for="edit-total-lectures">Total Lectures</label>
                    <input type="number" id="edit-total-lectures" min="1" required>
                </div>

                <div class="form-group">
                    <label for="edit-target-percent">Target %</label>
                    <input type="number" id="edit-target-percent" min="1" max="100" required>
                </div>

                <div class="form-group">
                    <label for="edit-attended">Attended Lectures</label>
                    <input type="number" id="edit-attended" min="0" required>
                </div>

                <div class="edit-actions">
                    <button type="button" id="reset-attendance" class="btn btn-danger">Reset Attendance</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- iOS Install Banner -->
    <div id="ios-install-banner" class="install-banner" style="display: none;">
        <div class="banner-content">
            <div class="banner-icon">📱</div>
            <div class="banner-text">
                <h3>Add Attendr to Your Home Screen</h3>
                <p>Tap <strong>Share</strong> below, then <strong>Add to Home Screen</strong> for the full app experience!</p>
            </div>
            <button id="close-ios-banner" class="close-banner-btn">&times;</button>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast" class="toast" style="display: none;">
        <span id="toast-message">Attendance logged!</span>
    </div>

    <!-- Scripts -->
    <script src="app.js"></script>
</body>
</html>
